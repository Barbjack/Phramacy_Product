<Page x:Class="Phramacy_Product.Views.Sales.SaleReturn"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:Phramacy_Product.Views.Sales"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="SaleReturn"
      mc:Ignorable="d">
    <Page.Resources>
        <Style x:Key="WhiteHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Background" Value="DarkBlue"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <Style x:Key="UserDefinedButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="DarkBlue"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="Width" Value="120"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
        </Style>

        <Style x:Key="UniformGridBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="#E3F2FD"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="4"/>
        </Style>
    </Page.Resources>
    <Grid>
        <materialDesign:Card Padding="16" materialDesign:ShadowAssist.ShadowDepth="Depth2" Margin="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="8,0,20,8">
                    <TextBlock FontWeight="Bold" Foreground="DarkBlue" FontSize="24" Text="Sale Return" VerticalAlignment="Center"/>
                    <Grid HorizontalAlignment="Right" Margin="870,0,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Style="{StaticResource UniformGridBorderStyle}" Width="100" Height="47">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock x:Name="Owner" Text="Owner" Foreground="DimGray" FontSize="12" Margin="0,0,20,0"/>
                            </StackPanel>
                        </Border>
                        <TextBox Grid.Column="1" x:Name="SearchBox" Width="200" materialDesign:HintAssist.Hint="Search by Bill Number"
                                 Margin="8,0,12,0" VerticalAlignment="Center"
                                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                 Text="{Binding TxtBillNumber, UpdateSourceTrigger=PropertyChanged}"/>
                        <Button Grid.Column="2" Height="48" Content="Search" Margin="0,0,0,0" Style="{StaticResource UserDefinedButtonStyle}"
                                Click="SearchButton_Click"/>
                    </Grid>
                </StackPanel>

                <UniformGrid Grid.Row="1" Columns="4" Margin="0,8,13,8">
                    <Border Style="{StaticResource UniformGridBorderStyle}">
                        <StackPanel>
                            <TextBlock Text="Customer" Foreground="#888" FontSize="12"/>
                            <TextBlock Text="{Binding CurrentSale.CustomerName}" FontSize="16" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Style="{StaticResource UniformGridBorderStyle}">
                        <StackPanel>
                            <TextBlock Text="Bill Number" Foreground="#888" FontSize="12"/>
                            <TextBlock Text="{Binding CurrentSale.BillNumber}" FontSize="16" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Style="{StaticResource UniformGridBorderStyle}">
                        <StackPanel>
                            <TextBlock Text="Bill Date" Foreground="#888" FontSize="12"/>
                            <TextBlock Text="{Binding CurrentSale.BillDate, StringFormat={}{0:MM/dd/yyyy}}" FontSize="16" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                    <Border Style="{StaticResource UniformGridBorderStyle}">
                        <StackPanel>
                            <TextBlock Text="Total Amount" Foreground="#888" FontSize="12"/>
                            <TextBlock Text="{Binding CurrentSale.TotalAmount, StringFormat=₹{0:F2}}" FontSize="16" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                </UniformGrid>

                <DataGrid x:Name="SaleItemsGrid"
                          Grid.Row="2"
                          ItemsSource="{Binding PagedSaleItems}"
                          SelectedItem="{Binding SelectedSaleItem, Mode=TwoWay}"
                          AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          IsReadOnly="False"
                          Height="500"
                          Margin="0,0,0,8"
                          HeadersVisibility="Column"
                          ColumnHeaderHeight="40"
                          ColumnHeaderStyle="{StaticResource WhiteHeaderStyle}">
                    <DataGrid.Columns>
                        <DataGridCheckBoxColumn Header="Select" Binding="{Binding IsSelected}" Width="*"/>
                        <DataGridTextColumn Header="Return Qty" Binding="{Binding ReturnQty}" Width="*"/>
                        <DataGridTextColumn Header="Item Name" Binding="{Binding ItemName}" Width="2*"/>
                        <DataGridTextColumn Header="Batch" Binding="{Binding Batch}" Width="*"/>
                        <DataGridTextColumn Header="Expiry" Binding="{Binding Expiry}" Width="*"/>
                        <DataGridTextColumn Header="Full Qty" Binding="{Binding FullQty}" Width="*"/>
                        <DataGridTextColumn Header="Loose Qty" Binding="{Binding LooseQty}" Width="*"/>
                        <DataGridTextColumn Header="MRP" Binding="{Binding MRP, StringFormat=₹{0:F2}}" Width="*"/>
                        <DataGridTextColumn Header="Discount" Binding="{Binding Discount, StringFormat={}{0:F2}%}" Width="*"/>
                        <DataGridTextColumn Header="GST" Binding="{Binding GST, StringFormat={}{0:F2}%}" Width="*"/>
                        <DataGridTextColumn Header="Net Amount" Binding="{Binding NetAmount, StringFormat=₹{0:F2}}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>

                <Grid Grid.Row="3">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Total Return Amount:" FontWeight="Bold" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding ReturnTotal, StringFormat=₹{0:F2}}" FontSize="16" FontWeight="Bold"
                       Foreground="#1976D2" VerticalAlignment="Center"/>
                    </StackPanel>
                    <Button Grid.Column="1"
                Content="Submit Return"
                Background="DarkBlue"
                Margin="0,0,8,0"
                HorizontalAlignment="Right"
                Click="SubmitReturnButton_Click"/>
                </Grid>
            </Grid>
        </materialDesign:Card>
    </Grid>
</Page>